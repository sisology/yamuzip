<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="team.trillion.yamuzip.admin.model.dao.OrderMapper">

<!--    <resultMap id="orderResultResultMap" type="team.trillion.yamuzip.admin.model.dto.OrderResultDTO">-->
<!--        <id property="orderCode" column="order_code"/>-->
<!--    </resultMap>-->

    <select id="findAllOrder" resultType="team.trillion.yamuzip.admin.model.dto.OrderDTO">
        SELECT
            o.order_code,
            p.pay_price,
            s.service_title,
            o.order_datetime,
            p.pay_datetime
        FROM
            tbl_order o
                LEFT JOIN tbl_payment p on (o.order_code = p.order_code)
                LEFT JOIN tbl_service s on (o.service_code = s.service_code)
        ORDER BY
            order_code;
    </select>

    <select id="selectOrderDetail" resultType="team.trillion.yamuzip.admin.model.dto.OrderDetailDTO">
        SELECT
            o.order_code,
            o.order_datetime,
            o.cancel_datetime,
            o.cancel_reason,
            o.order_status,
            u.user_name,
            p.pay_type,
            s.service_title
        FROM
            tbl_order o
                JOIN tbl_service s on s.service_code = o.service_code
                LEFT JOIN tbl_payment p on (o.order_code = p.order_code)
                LEFT JOIN tbl_user u on u.user_code = o.user_code
        WHERE
            o.order_code = #{ orderCode };
    </select>

</mapper>